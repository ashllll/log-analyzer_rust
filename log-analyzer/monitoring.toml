# Production Monitoring Configuration
# This file configures the comprehensive monitoring system for the log analyzer

[monitoring]
# Enable/disable monitoring system
enabled = true

# Monitoring data retention period (in seconds)
retention_period = 86400  # 24 hours

# Metrics collection interval (in seconds)
collection_interval = 60  # 1 minute

# Performance tracking settings
[performance]
# Maximum number of performance measurements to keep in memory
max_measurements = 10000

# Performance baseline update threshold (percentage)
baseline_update_threshold = 10.0

# Performance regression detection threshold (percentage)
regression_threshold = 20.0

# Benchmark settings
[benchmarks]
# Enable automated benchmark runs
auto_run_enabled = true

# Benchmark run interval (in seconds)
run_interval = 3600  # 1 hour

# Benchmark timeout (in seconds)
timeout = 300  # 5 minutes

# Performance regression threshold for benchmarks (percentage)
regression_threshold = 15.0

# Benchmark suites to run
suites = [
    "cache_benchmarks",
    "search_benchmarks", 
    "validation_benchmarks",
    "production_benchmarks"
]

# Alert thresholds
[alerts]
# CPU usage alert threshold (percentage)
cpu_usage_threshold = 80.0

# Memory usage alert threshold (percentage)
memory_usage_threshold = 85.0

# Disk usage alert threshold (percentage)
disk_usage_threshold = 90.0

# Error rate alert threshold (percentage)
error_rate_threshold = 5.0

# Response time P95 alert threshold (milliseconds)
response_time_p95_threshold = 2000.0

# Cache hit rate alert threshold (percentage, minimum)
cache_hit_rate_threshold = 70.0

# Alert cooldown period (in seconds)
alert_cooldown = 300  # 5 minutes

# Metrics configuration
[metrics]
# Enable specific metric categories
enable_system_metrics = true
enable_performance_metrics = true
enable_cache_metrics = true
enable_search_metrics = true
enable_validation_metrics = true

# Histogram buckets for latency measurements (in milliseconds)
latency_buckets = [1.0, 5.0, 10.0, 25.0, 50.0, 100.0, 250.0, 500.0, 1000.0, 2500.0, 5000.0]

# Counter metrics to track
counters = [
    "search_operations_total",
    "cache_hits_total", 
    "cache_misses_total",
    "validation_errors_total",
    "workspace_operations_total",
    "file_operations_total",
    "archive_extractions_total"
]

# Gauge metrics to track
gauges = [
    "active_searches",
    "cache_size_bytes",
    "memory_usage_bytes",
    "cpu_usage_percent",
    "disk_usage_percent",
    "active_workspaces",
    "indexed_files_count"
]

# Histogram metrics to track
histograms = [
    "search_duration_ms",
    "cache_operation_duration_ms", 
    "validation_duration_ms",
    "file_operation_duration_ms",
    "workspace_operation_duration_ms"
]

# Sentry configuration
[sentry]
# Enable Sentry integration
enabled = true

# Sentry DSN (set via environment variable SENTRY_DSN)
# dsn = "https://your-dsn@sentry.io/project-id"

# Sample rate for performance monitoring (0.0 to 1.0)
traces_sample_rate = 0.1

# Sample rate for error monitoring (0.0 to 1.0)
error_sample_rate = 1.0

# Environment name for Sentry
environment = "production"

# Release version (automatically detected from git)
# release = "1.0.0"

# Dashboard configuration
[dashboard]
# Enable monitoring dashboard
enabled = true

# Dashboard refresh interval (in seconds)
refresh_interval = 30

# Number of recent alerts to show
max_recent_alerts = 10

# Number of top/concerning benchmark results to show
max_benchmark_results = 5

# Export formats supported
export_formats = ["json", "html"]

# CI/CD Integration
[ci_cd]
# Enable CI/CD benchmark integration
enabled = true

# Benchmark comparison baseline branch
baseline_branch = "main"

# Performance regression threshold for CI/CD (percentage)
ci_regression_threshold = 25.0

# Fail CI/CD on performance regression
fail_on_regression = false

# Maximum benchmark runtime in CI/CD (in seconds)
max_benchmark_time = 600  # 10 minutes

# Logging configuration for monitoring
[logging]
# Log level for monitoring components
level = "info"

# Enable structured logging
structured = true

# Log monitoring events to file
log_to_file = true

# Monitoring log file path
log_file = "logs/monitoring.log"

# Log rotation settings
max_log_size_mb = 100
max_log_files = 5