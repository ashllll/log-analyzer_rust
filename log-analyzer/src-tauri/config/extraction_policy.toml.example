# Enhanced Archive Extraction Policy Configuration
# This file controls the behavior of the archive extraction system

[extraction]
# Maximum nesting depth for archives (1-20)
max_depth = 10

# Maximum file size in bytes (100MB)
max_file_size = 104857600

# Maximum total size per archive in bytes (10GB)
max_total_size = 10737418240

# Maximum total size per workspace in bytes (50GB)
max_workspace_size = 53687091200

# Number of concurrent extractions (0 = auto-detect based on CPU cores)
concurrent_extractions = 0

# Buffer size for streaming extraction in bytes (64KB)
buffer_size = 65536

# Use enhanced extraction system (default: false for backward compatibility)
# Set to true to enable advanced features:
# - Long path support (>255 characters)
# - Deep nesting support (configurable depth)
# - Zip bomb detection
# - Path shortening with mapping
# - Resumable extractions
use_enhanced_extraction = false

[security]
# Compression ratio threshold for flagging suspicious files
compression_ratio_threshold = 100.0

# Exponential backoff threshold (ratio^depth)
exponential_backoff_threshold = 1000000.0

# Enable zip bomb detection
enable_zip_bomb_detection = true

[paths]
# Enable Windows long path support (UNC prefix \\?\)
enable_long_paths = true

# Path shortening threshold (0.0-1.0)
# Paths exceeding this percentage of OS limit will be shortened
shortening_threshold = 0.8

# Hash algorithm for path shortening (SHA256 or SHA512)
hash_algorithm = "SHA256"

# Length of hash for shortened paths (8-32)
hash_length = 16

[performance]
# Temporary directory TTL in hours
temp_dir_ttl_hours = 24

# Log retention in days
log_retention_days = 90

# Enable streaming extraction (reduces memory usage)
enable_streaming = true

# Directory creation batch size
directory_batch_size = 10

# Parallel files per archive (1-8)
parallel_files_per_archive = 4

[audit]
# Enable audit logging
enable_audit_logging = true

# Log format: "json" or "text"
log_format = "json"

# Log level: "trace", "debug", "info", "warn", "error"
log_level = "info"

# Enable security event logging
log_security_events = true
